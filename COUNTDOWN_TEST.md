# 倒计时功能测试说明

## 🎯 功能描述

AutoPurge 扩展现在具有真实的倒计时功能：
- 当检测到匹配的网站时，会显示倒计时（如：10s, 9s, 8s...）
- 倒计时结束后自动执行删除操作
- 删除完成后显示 "Removed" 状态

## 🧪 测试步骤

### 步骤 1: 启用扩展
1. 打开 AutoPurge 扩展弹窗
2. 确保状态显示为 "Active"
3. 如果没有启用，点击 "Enable" 按钮

### 步骤 2: 访问测试网站
1. 访问一个在监控列表中的网站（如：baidu.com）
2. 扩展应该检测到网站并启动倒计时
3. 倒计时应该从配置的延迟时间开始（默认 10 秒）

### 步骤 3: 观察倒计时
1. 倒计时应该显示为：10s, 9s, 8s, 7s...
2. 倒计时不应该循环或重复
3. 倒计时结束后应该自动执行删除

### 步骤 4: 查看删除状态
1. 删除完成后应该显示绿色的 "Removed" 状态
2. 5 秒后自动恢复到原始状态

## 🔍 如果出现问题

### 问题 1: 倒计时不显示
**可能原因：**
- 扩展未启用
- 网站不在监控列表中
- JavaScript 错误

**解决方案：**
1. 检查扩展状态
2. 查看浏览器控制台错误
3. 点击 "Reset" 按钮重置状态

### 问题 2: 倒计时循环
**可能原因：**
- 状态检查重复触发
- 倒计时函数重复调用

**解决方案：**
1. 点击 "Reset" 按钮强制重置
2. 检查控制台日志
3. 刷新页面重新开始

### 问题 3: 倒计时格式错误
**期望格式：** 10s, 9s, 8s...
**如果显示：** 10, 9, 8...
**解决方案：** 刷新页面或点击 "Reset" 按钮

## 🛠️ 调试工具

### 控制台命令
在浏览器控制台（F12）中可以使用以下命令：

```javascript
// 查看倒计时状态
console.log(window.popupDebug.getCountdownState());

// 手动启动倒计时（10秒）
window.popupDebug.startCountdown(10);

// 停止倒计时
window.popupDebug.stopCountdown();

// 强制重置所有状态
window.popupDebug.forceReset();

// 查看当前配置
console.log(window.popupDebug.config);
```

### 调试按钮
- **Refresh**: 刷新当前网站状态
- **Reset**: 强制重置所有倒计时状态

## 📝 预期行为

### 正常倒计时流程：
1. 检测到网站 → 显示倒计时
2. 倒计时进行：10s → 9s → 8s → ... → 1s
3. 倒计时结束 → 执行删除
4. 删除完成 → 显示 "Removed"
5. 5秒后 → 恢复原始状态

### 倒计时特点：
- ✅ 显示格式：数字 + "s"（如：10s）
- ✅ 只执行一次，不循环
- ✅ 可以手动停止和重置
- ✅ 删除完成后有明确的状态反馈

## 🚀 下一步

如果倒计时功能正常工作，你可以：
1. 调整删除延迟时间（在设置中）
2. 测试不同网站的检测
3. 验证删除操作是否成功
4. 检查统计数据的更新

如果仍有问题，请提供：
1. 具体的错误现象
2. 控制台错误信息
3. 操作步骤
4. 期望的行为
